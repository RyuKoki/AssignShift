<h1 class="headerer">
	<%= link_to 'Assign shift', root_path %>
</h1>

<h1> 
	<%= @department_name %> 
</h1>

<script type="text/javascript">         
      setTimeout("location.reload();",10000);
</script>

<%= link_to 'Plan', edit_dashboard_path(@department_name) %><br>

<% day = Time.current.strftime("%Y-%m-%d") %>
<% date = day.to_time %>

<table>
	<thead>
		<tr>
			<th> ชื่อ-นามสกุล </th>
			<th> เวลาเข้างาน </th>
			<th> เวลาออกงาน </th>
			<th> OT </th>
		</tr>
	</thead>
	<tbody>
		<% @all_workers.each do |worker| %>
			<tr>
				<td><%= worker.name + " " + worker.surname %></td>
				<% worker_all_plan = worker.plans.find_by_date(date) %>
				<% worker_all_actuals = worker.actuals.find_by_date(date) %>

				<% if worker_all_actuals != nil %>

					<% if worker_all_actuals.time_in != nil %>
						<td><%= worker_all_actuals.time_in.strftime('%H:%M:%S') + '/' + worker_all_plan.time_in.strftime('%H:%M:%S') %></td>
					<% else %>
						<td><%= '-/' + worker_all_plan.time_in.strftime('%H:%M:%S') %></td>
					<% end %>

					<% if worker_all_actuals.time_out != nil %>
						<td><%= worker_all_actuals.time_out.strftime('%H:%M:%S') + '/' + worker_all_plan.time_out.strftime('%H:%M:%S') %></td>
					<% else %>
						<td><%= '-/' + worker_all_plan.time_out.strftime('%H:%M:%S') %></td>
					<% end %>

					<% if worker_all_actuals.OT != nil %>
						<td><%= worker_all_actuals.OT %></td>
					<% else %>
						<td><%= '-/' + worker_all_plan.OT %></td>
					<% end %>

				<% else %>
					<% if worker_all_plan != nil %>
						<td><%= '-/' + worker_all_plan.time_in.strftime('%H:%M:%S') %></td>
						<td><%= '-/' + worker_all_plan.time_out.strftime('%H:%M:%S') %></td>
						<td><%= '-/' + worker_all_plan.OT.to_s %></td>
					<% else %>
						<td> - </td>
						<td> - </td>
						<td> - </td>
					<% end %>
				<% end %>
			</tr>
		<% end %>
	</tbody>
</table>
